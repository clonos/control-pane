<dialog id="raid-add" class="window-box info-box" style="width:80%;height:80%;">
	<h1 class="tabs">
		<span>Add new RAID</span>
	</h1>
	<div class="window-content smpad flex">
		<div class="pages new-raid" data-page="1" data-title="Select Disks">
			<div class="column raids-types">
				<ul></ul>
			</div>
			<div class="column disks-list">
				<div id="notavail" class="hide">
					<h2>Создание <span id="notavail-rname">RAID</span> невозможно!</h2>
					<p>К сожалению, для создания данного вида RAID недостаточно дисков в Вашем NAS. Не хватает ещё N дисков.</p>
					<p>Вам необходимо добавить дополнительные носители информации.</p>
				</div>
				<div id="avail" class="hide">
					<h2>Создание <span id="raid-name">&hellip;</span></h2>
					<p>Для данного типа RAID необходимое количество дисков: <strong><span id="disks-need">N</span></strong>.</p>
					<p>Выбрано дисков: <span id="disks-sel"><strong><span class="red">N</span></strong></span>.</p>
					<p>Размер получаемого хранилища: <strong><span id="raid-size">&hellip;</span></strong>
					<form id="disks-list" method="post" onsubmit="return false;"></form>
				</div>
			</div>
			<div class="column description"></div>
		</div>
		<div class="pages raid-settings hide" data-page="2" data-title="Add Settings">
			<div style="width:80%;margin:10px auto;">
			<h2>Настройки RAID</h2>
			<br />
<?php
$db = new Db('file','/zmirror/jails/formfile/dsk.sqlite');
if($db->error){
	echo 'DB not found';
}else{
	$db_path = $db->getFileName();
	$res_html = (new DialogsGen($db_path))->generate();
	echo $res_html;
}
?>
			</div>
		</div>
		<div class="pages raid-create hide" data-page="3"  data-title="Create RAID">
			<h2>Создание RAID</h2>
			<p><strong>Проверьте настройки создания массива.</strong></p>
			<ul>
				<li><span>Тип RAID:</span><span data-name=""></span></li>
			</ul>
		</div>
	</div>
	<div class="buttons flex2col">
		<div class="pages">
			<span class="circle open">1</span> <span>Select Disks</span>
			<span class="longline"></span>
			<span class="circle">2</span> <span>Add Settings</span>
			<span class="longline"></span>
			<span class="circle">3</span> <span>Create RAID</span>
		</div>
		<div class="pbuttons first">
			<input type="button" value="&#8592; Prev" class="button blue" data-btn="prev" />
			<input type="button" value="Next &#8594;" class="button blue" data-btn="next" />
			<input type="button" value="Create RAID" class="button blue" data-btn="create" />
			<input type="button" value="Cancel" class="button red" data-btn="cancel" />
		</div>
	</div>
</dialog>
<template id="tpl-engine">
	<li#sel# data-reng="#index#">
		<span class="#avail#"></span>#ename# <small>(#raid_level#)</small>
	</li>
</template>
<template id="create-few">(мало)</template>
<template id="create-many">(много)</template>
<template id="create-success">(можно создать RAID)</template>
<template id="tpl-disks">
	<div class="dline">
		<input type="checkbox" name="#disk#" id="disk-#num#" /><label for="disk-#num#">#disk# (#type#). <strong>#capacity_human#.</strong> #model# (#ident#)</label>
	</div>
</template>
<template id="annot-zpool_raid1">
	<p><strong>RAID 1</strong> (зеркалирование) — это технология объединения минимум двух дисков, которые являются точными копиями друг друга, обеспечивая высокую отказоустойчивость: данные записываются на каждый диск одновременно, и если один выходит из строя, система продолжает работать с другого диска без потери данных. Преимущества — высокая надёжность, отличная скорость чтения (за счёт параллельного доступа), недостаток — низкая эффективность использования пространства, так как доступен объём только одного диска, а также более высокая стоимость за гигабайт.</p>
	<p><strong>Как это работает</strong></p>
	<ul>
		<li><strong>Зеркалирование:</strong> Все данные дублируются в реальном времени на два (или более) диска.</li>
		<li><strong>Отказоустойчивость:</strong> Массив работает, пока исправен хотя бы один диск; при сбое одного диска второй продолжает обслуживать запросы.</li>
		<li><strong>Скорость:</strong> Высокая скорость чтения за счёт параллельного чтения с обоих дисков, но скорость записи остается как у одного диска (или немного ниже из-за дублирования).</li>
	</ul>
	<p><strong>Плюсы</strong></p>
	<ul>
		<li>Высокая надёжность и доступность данных.</li>
		<li>Простота реализации и восстановления.</li>
		<li>Ускоренное чтение.</li>
	</ul>
	<p><strong>Минусы</strong></p>
	<ul>
		<li>Высокая стоимость за гигабайт (100% избыточность).</li>
		<li>Низкая эффективность использования дискового пространства (доступен только объём одного диска).</li>
	</ul>
	<p><strong>Для чего используется</strong></p>
	<ul>
		<li>Для систем, где надёжность и доступность данных важнее стоимости и объёма хранилища.</li>
		<li>Для зеркалирования системных дисков серверов.</li>
	</ul>
</template>
<template id="annot-zpool_raid5">
	<p><strong>RAID 5</strong> (Redundant Array of Independent Disks 5) — популярная конфигурация RAID, которая обеспечивает отказоустойчивость и производительность за счёт <strong>чередования данных и распределения блоков контроля чётности</strong> (parity) по всем дискам, требуя минимум три диска, и позволяя пережить отказ одного диска без потери данных. Это хороший компромисс между скоростью и надёжностью, где доступная ёмкость равна ёмкости всех дисков минус объём одного.</p>
	<p><strong>Как это работает:</strong></p>
	<ol>
		<li><strong>Чередование (Striping):</strong> Данные разбиваются на блоки и записываются последовательно на разные диски, что ускоряет чтение.</li>
		<li><strong>Контроль четности (Parity):</strong> Специальный блок четности, вычисляемый из данных, распределяется по всем дискам (не на отдельный диск, как в RAID 4).</li>
		<li><strong>Отказоустойчивость:</strong> Если один диск выходит из строя, данные восстанавливаются с оставшихся дисков с помощью информации чётности.</li>
	</ol>
	<p><strong>Преимущества:</strong></p>
	<ul>
		<li><strong>Отказоустойчивость:</strong> Выдерживает отказ одного диска.</li>
		<li><strong>Эффективное использование пространства:</strong> Доступный объём больше, чем в RAID 1.</li>
		<li><strong>Высокая скорость чтения:</strong> Благодаря чередованию.</li>
		<li><strong>Распределённая чётность:</strong> Улучшает производительность записи по сравнению с RAID 4.</li>
	</ul>
	<p><strong>Недостатки:</strong></p>
	<ol>
		<li><strong>Замедление записи:</strong> Вычисление и запись чётности замедляют операции записи.</li>
		<li><strong>Риск во время восстановления (Rebuild):</strong> Во время перестроения массива нагрузка на диски возрастает, и выход из строя второго диска в этот момент ведёт к потере данных.</li>
		<li><strong>Сложность:</strong> Требует более сложного контроллера.</li>
	</ol>
	<p><strong>Когда использовать:</strong></p>
	<p>RAID 5 идеально подходит для серверов, где важен баланс между скоростью чтения, надёжностью и экономией пространства, например, для файловых серверов или приложений с высокой интенсивностью чтения.</p>
</template>
<template id="annot-zpool_raid6">
	<p><strong>RAID 6</strong> — это уровень дискового массива, обеспечивающий высокую отказоустойчивость за счёт использования двойной контрольной суммы (P+Q parity), что позволяет системе работать при одновременном выходе из строя до двух дисков. Требует минимум 4 диска. Обеспечивает высокую скорость чтения, но имеет низкую скорость записи из-за двойных вычислений.</p>
	<p><strong>Основные характеристики и преимущества:</strong></p>
	<ul>
		<li><strong>Отказоустойчивость:</strong> Выдерживает выход из строя двух дисков без потери данных, что надежнее RAID 5.
		<li><strong>Ёмкость:</strong> Доступный объём рассчитывается как (N-2)×S (где N — число дисков, S — объём наименьшего диска).</li>
		<li><strong>Скорость:</strong> Высокая скорость чтения, значительно более медленная запись по сравнению с RAID 5 из-за сложных вычислений.</li>
		<li><strong>Применение:</strong> Подходит для архивных хранилищ, видеонаблюдения и критически важных данных, где важна сохранность, а не скорость записи.</li>
	</ul>
	<p><strong>Недостатки:</strong></p>
	<ul>
		<li>Самая низкая производительность записи (IOPS) среди распространенных RAID.</li>
		<li>Требует минимум 4-х дисков, полезный объём меньше, чем у RAID 5.</li>
	</ul>
	<p>RAID 6 часто используется, когда ёмкость дисков очень велика, и время восстановления после одного отказа (RAID 5) создаёт риск потери данных из-за выхода из строя второго диска.</p>
</template>
<template id="annot-zpool_raid10">
	<p><strong>RAID 10</strong> (или RAID 1+0) — это комбинированный уровень RAID, объединяющий зеркалирование (RAID 1) и чередование (RAID 0) для обеспечения высокой производительности и надёжности. Требует минимум 4 диска (чётное количество). Это «зеркало из полос», обеспечивающее быструю запись/чтение и способность пережить выход из строя одного диска в каждой зеркальной паре.</p>
	<p><strong>Ключевые особенности RAID 10:</strong></p>
	<ul>
		<li><strong>Производительность:</strong> Высокая скорость чтения и записи, так как данные распределяются по разным зеркальным парам.</li>
		<li><strong>Отказоустойчивость:</strong> Данные сохраняются при выходе из строя до 50% дисков, при условии, что не выходят из строя оба диска в одной зеркальной паре.</li>
		<li><strong>Ёмкость:</strong> Эффективность использования дискового пространства составляет 50% (доступно (S×N/2), где S — объём диска, N — число дисков).</li>
		<li><strong>Применение:</strong> Идеально для высоконагруженных баз данных (Oracle, SQL), веб-серверов и систем с интенсивным вводом-выводом.</li>
	</ul>
	<p><strong>Преимущества и недостатки:</strong></p>
	<ul>
		<li><strong>Плюсы:</strong> Быстрое восстановление данных (ребилд), отсутствие вычислений контрольных сумм (быстрее RAID 5/6 при записи).</li>
		<li><strong>Минусы:</strong> Высокая стоимость (используется половина общей ёмкости).</li>
	</ul>
	<p>RAID 10 часто выбирают, когда производительность и надёжность важнее стоимости дискового пространства.</p>
</template>
<template id="annot-zpool_raid50">
	<p><strong>RAID 50</strong> (или RAID 5+0) — это гибридный уровень RAID, объединяющий чередование данных (RAID 0) поверх нескольких массивов с контролем чётности (RAID 5). Он обеспечивает высокую производительность чтения/записи и хорошую отказоустойчивость, выдерживая выход из строя по одному диску в каждом подмассиве. Требует минимум 6 дисков.</p>
	<p><strong>Ключевые особенности RAID 50:</strong></p>
	<ul>
		<li><strong>Структура:</strong> Несколько наборов RAID 5, объединённых в страйп (RAID 0).</li>
		<li><strong>Отказоустойчивость:</strong> Выдерживает выход из строя (N) дисков, где (N) — количество подмассивов RAID 5 (при условии, что в каждом наборе отказал только один диск).</li>
		<li><strong>Ёмкость:</strong> Рассчитывается как ((N<sub>общ</sub>-N<sub>групп</sub>)×C<sub>диска</sub>).</li>
		<li><strong>Производительность:</strong> Высокая скорость записи (выше, чем у RAID 5) и очень высокая скорость чтения.</li>
		<li><strong>Применение:</strong> Подходит для систем с интенсивной записью, баз данных, файловых серверов, где важен баланс ёмкости, производительности и надёжности.</li>
		<li><strong>Минимум дисков:</strong> Для создания требуются минимум 6 дисков.</li>
	</ul>
	<p><strong>Преимущества и недостатки:</strong></p>
	<ul>
		<li><strong>Плюсы:</strong> Быстрое восстановление по сравнению с RAID 5 (из-за меньшего размера подмассивов), высокая производительность, высокая ёмкость.</li>
		<li><strong>Минусы:</strong> Требует дорогого аппаратного контроллера, высокая стоимость (минимум 6 дисков), риск потери данных при выходе из строя 2-х дисков в одном подмассиве.</li>
	</ul>
	<p>RAID 50 является надёжной альтернативой RAID 5, обеспечивая более высокую отказоустойчивость и скорость.</p>
</template>
<template id="annot-zpool_raid60">
	<p><strong>RAID 60</strong> (или RAID 6+0) — это комбинированный уровень RAID, объединяющий производительность RAID 0 (страйпинг) с отказоустойчивостью нескольких массивов RAID 6 (двойная чётность), что обеспечивает высокую скорость и надёжность, позволяя пережить отказ двух дисков в каждом отдельном под-массиве RAID 6 без потери данных, хотя и требует минимум 8 дисков, сложного контроллера и имеет более низкую эффективность использования пространства по сравнению с другими уровнями.</p>
	<p><strong>Принцип работы</strong></p>
	<ul>
		<li><strong>Страйпинг (RAID 0):</strong> Данные разбиваются на блоки и распределяются по нескольким группам (спанам) дисков, что увеличивает скорость чтения/записи.</li>
		<li><strong>RAID 6:</strong> Каждая группа дисков работает как массив RAID 6, используя две контрольные суммы (чётности) для защиты от отказа до двух дисков в этой группе.</li>
		<li><strong>Итог:</strong> Получается массив из нескольких RAID 6-групп, соединённых через RAID 0, что обеспечивает масштабируемую производительность и высокую отказоустойчивость.</li>
	</ul>
	<p><strong>Преимущества:</strong></p>
	<ul>
		<li><strong>Высокая отказоустойчивость:</strong> Может выдержать одновременный выход из строя двух дисков в каждом отдельном RAID 6 сегменте.</li>
		<li><strong>Высокая производительность:</strong> Страйпинг улучшает скорость передачи данных.</li>
		<li><strong>Масштабируемость:</strong> Позволяет наращивать производительность и ёмкость.</li>
	</ul>
	<p><strong>Недостатки:</strong></p>
	<ul>
		<li><strong>Высокие требования к оборудованию:</strong> Нужны как минимум 8 дисков и мощный RAID-контроллер.</li>
		<li><strong>Высокая стоимость:</strong> Больше дисков, дороже контроллер.</li>
		<li><strong>Низкая эффективность:</strong> Потеря пространства под контрольные суммы.</li>
		<li><strong>Сложность восстановления:</strong> Восстановление после сбоя сложнее, чем у RAID 10.</li>
	</ul>
	<p><strong>Для чего используется:</strong></p>
	<ul>
		<li>Критически важные приложения и системы хранения данных, где требуется сочетание высокой доступности и производительности, например, в больших корпоративных системах.</li>
	</ul>
</template>
<template id="annot-zpool_raid0">
	<p><strong>RAID 0</strong> (чередование, striping) — это конфигурация дисков, которая объединяет два или более накопителя для повышения скорости чтения/записи и увеличения общей ёмкости, разбивая данные на блоки и записывая их параллельно на все диски. <strong>Преимущество:</strong> максимальная производительность и эффективное использование пространства. <strong>Главный недостаток:</strong> отсутствие избыточности, из-за чего отказ одного диска приводит к полной потере всех данных в массиве. Рекомендуется для некритичных данных, где важна скорость, с обязательным резервным копированием.</p> 
	<p><strong>Как это работает</strong></p>
	<ul>
		<li><strong>Разделение данных (Striping):</strong> Данные делятся на небольшие блоки. Первый блок записывается на диск 1, второй на диск 2, и так далее.</li>
		<li><strong>Параллельная обработка:</strong> При чтении или записи данных все диски работают одновременно, что значительно ускоряет процесс.</li>
		<li><strong>Минимальное количество дисков:</strong> 2.</li>
	</ul>
	<p><strong>Преимущества</strong></p>
	<ul>
		<li><strong>Высокая производительность:</strong> Значительно ускоряет операции ввода/вывода.</li>
		<li><strong>100% эффективность:</strong> Используется вся доступная ёмкость всех дисков.</li>
		<li><strong>Простота настройки:</strong> Легко реализуется и не требует сложных контроллеров.</li>
	</ul>
	<p><strong>Недостатки</strong></p>
	<ul>
		<li><strong>Нулевая отказоустойчивость:</strong> Нет резервирования. Выход из строя любого диска означает потерю всего массива.</li>
		<li><strong>Низкая надёжность:</strong> Надёжность падает с увеличением количества дисков.</li>
	</ul>
	<p><strong>Когда использовать</strong></p>
	<ul>
		<li>Для временных файлов, кэширования, обработки видео/фото, где скорость важнее сохранности.
		<li><strong>Никогда</strong> для хранения критически важных данных, если нет надёжной системы резервного копирования. 
</template>
